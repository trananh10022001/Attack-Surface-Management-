import io

import requests
from bs4 import BeautifulSoup

# tech = input('nhap domain: ') # Tên công nghệ bạn muốn tìm kiếm
tech = 'cloudflare'
url = f'https://vulmon.com/searchpage?q={tech}&sortby=byrelevance'
response = requests.get(url)
doc = response.text
file = io.open('magic.html', mode = 'w', encoding='utf8')
file.write(doc)
soup = BeautifulSoup(response.content, 'html.parser')

text = ""
text1 = soup.find_all('a', class_= 'header')
list1=[]
for i in text1 :
    if(str(i).__contains__("header item") == False):
        soup2 = BeautifulSoup(i.text,'html.parser')
        title = soup2.extract('a')
        list1.append(title)

list2 = []
text2 = soup.find_all('div',class_='value')
for i in text2:
    soup3 = BeautifulSoup(i.text, 'html.parser')
    cvss_point = soup3.extract('div')
    list2.append(cvss_point)

list3 = []
text3 = soup.find_all('div',class_='description')
for i in text3:
    soup3 = BeautifulSoup(i.text, 'html.parser')
    Descript = soup3.extract('a')
    list3.append(Descript)

list4=[]
text4 = soup.find_all('div',class_='extra')
for i in text4:
    soup4 = BeautifulSoup(i.text, 'html.parser')
    web_tech = soup4.extract('a')
    list4.append(web_tech)
print(list4[0])

for i in text1:
    if (str(i).__contains__("header item") == False):
        cve = i.get('href')
        # print('https://vulmon.com'+cve.strip())



